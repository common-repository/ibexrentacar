<?php
/*
Plugin Name: Ibexrentacar
Plugin URI: http://www.ibexrentacar.com/
Description: Plugin de WordPress para conectar tu blog con la plataforma de gestión de Ibexrentacar.
Version: 1.7
Author: Ibexestudio
Author URI: http://www.ibexrentacar.com
*/
?>
<form method="post" action="options.php"><div class="postbox"> <div class="inside"> <div id="irc_sincronizeplace_load" style="display:none"> <div align="center"> <br /><img src="<?php  echo $GLOBALS['lsPluginPath'].'/img/pircloading.gif' ?>" width="100" /><br /><br /> <?php  echo _irct("Espere por favor, sincronizando lugares").'...'; ?><br /><br /> </div> </div> <div id="irc_sincronizeplace_box"> <div class="ircpright" style="margin-top:5px;"> <?php  foreach($this->wplanguages as $lang => $code){ ?> <div class="ircpleft" style="padding-right:5px;"> <a onclick="ircPlaceImportbyLanguage('<?php  echo $code['code'] ?>')" style="text-decoration: none"> <div id="ircp_langbutton_<?php  echo $code['code']?>" class="ircp_langbutton<?php  if($code['code']==$this->wplang){?><?php  echo "_active";?><?php  }?>"><div class="ircp_langbuttonContent"><?php  if(isset($code['country_flag_url']) && $code['country_flag_url']!=''){ ?><img src="<?php  echo $code['country_flag_url'] ?>" /><span class="langlabel"> <?php  echo $code['native_name'] ?></span><?php  }else{?><?php  echo $code['native_name'] ?><?php  }?></div></div> </a> </div> <?php  }?> </div> <div class="ircpclear"></div><hr class="irchrs" /> <?php  foreach($this->wplanguages as $lang => $code){ if(isset($irc_views['items']) && sizeof($irc_views['items'])){ foreach($irc_views['items'] as $ircv){ if($ircv['seourl_prefix']==$code['language_code'])$this->ircview = $ircv['view_id']; } } $wp_places = apirc_models(array('type' => $this->ws_setting['irc_sincro'], 'lang' => $code['language_code'])); $irc_places = ws_request("/models/place/visibleRecords",$this->ws_setting,array("view_id" => $this->ircview)); if(sizeof($wp_places->posts)){ $post_items_place = array(); foreach($wp_places->posts as $wp_place){ $model_irc_placeid = get_post_meta($wp_place->ID, 'irc_place_id', true); if(!empty($model_irc_placeid))$post_items_place[] = $wp_place;} $wp_places->posts = $post_items_place; }?> <div id="ircp_import_places_<?php  echo $code['code'] ?>" class="ircp_import_places" <?php  if($code['code']!=$this->wplang){?>style="display: none"<?php  }?>> <div class="irc_plugin_sincronize_table_item_col1"> <div style="padding:10px 0;"> <div class="ircpleft" style="padding-right:5px;"> <strong class="ircph2"> <?php  if(isset($this->irccompany['name'])){?><?php  echo ucfirst(mb_strtolower($this->irccompany['name'])) ?><?php  }else{?><?php  echo _irct("Ibexrentacar") ?><?php  }?> </strong> <div class="ircpclear"></div> <div class="ircpleft"><?php  echo $code['native_name'] ?></div> <div class="ircpclear"></div> </div> <div class="ircpright"> <div align="center"> <div class="ircpnumbox"> <strong><?php  echo sizeof($irc_places['items']) ?></strong> <div style="font-size:12px;line-height: 5px;padding-bottom: 10px;"><?php  echo _irct("Lugares") ?></div> </div> </div> </div> <div class="ircpclear"></div> <div align="center" style="font-size:12px; padding:0;"> <?php  $ircmplacenames = array(); if(isset($irc_places['items'])){ usort($irc_places['items'],function ($a,$b) { return $a["name"]>$b["name"]; });?> <?php  foreach($irc_places['items'] as $irc_place){ $ircmplacenames[$irc_place['name']] = $irc_place['name'];?> <div class="ircpleft colsynclist"><?php  echo ucfirst(mb_strtolower($irc_place['name'])) ?></div><div class="ircpclear"></div> <?php  }?> <?php  }else{?> <div class="ircpnoresults"><?php  echo _irct("No dispone de lugares IRC en") ?> <?php  echo $code['native_name'] ?>.</div> <?php  }?> </div> </div> </div> <div class="irc_plugin_sincronize_table_item_sep"> <div align="center"><img src="<?php  echo $GLOBALS['lsPluginPath'].'/img/arrowsep.png' ?>" width="15" /></div> </div> <div class="irc_plugin_sincronize_table_item_col2"> <div style="padding:10px 0;"> <div class="ircpleft" style="padding-right:5px;"> <strong style="font-size:1.5em; line-height:30px"><?php  echo _irct("Wordpress") ?></strong> <div class="ircpclear"></div> <div class="ircpleft"><?php  echo $code['native_name'] ?></div> <div class="ircpclear"></div> </div> <?php  if(sizeof($wp_places->posts)){?> <div class="ircpright"> <div align="center"> <div class="ircpnumbox"> <a href="/wp-admin/edit.php" style="text-decoration: none; color:#444" target="_blank"> <strong><?php  echo sizeof($wp_places->posts) ?></strong><div style="font-size:12px;line-height: 5px;padding-bottom: 10px;"><?php  echo _irct("Lugares") ?></div> </a> </div> </div> </div> <?php  }else{?> <div class="ircpright"> <div align="center"><img src="<?php  echo $GLOBALS['lsPluginPath'].'/img/noresult.png' ?>" width="50" style="margin-bottom:5px;" /></div> </div> <?php  }?> <div class="ircpclear"></div> <div align="center" style="font-size:12px; padding:0;"> <?php  if(sizeof($wp_places->posts)){ usort($wp_places->posts,function ($a,$b) { return $a->post_title>$b->post_title; });?> <?php  foreach($wp_places->posts as $wp_place){ $place_irc_id = get_post_meta($wp_place->ID, 'irc_place_id', true); ?> <a href="<?php  echo get_permalink($wp_place->ID) ?>" style="text-decoration:none" target="_blank"> <div class="ircpleft colsynclist"><?php  echo ucfirst(mb_strtolower($wp_place->post_title)) ?></div> <div class="ircpclear"></div> </a> <?php  }?> <div class="ircpclear"></div> <?php  }else{?> <br /><div><?php  echo _irct("No dispone de lugares en WP") ?> (<?php  echo $code['native_name'] ?>).<br /> <a href="#" onclick="sincronizaplace()" style="text-decoration: none"><?php  echo _irct("Sincronizar ahora") ?></a></div> <?php  }?> </div> </div> </div> <div class="ircpclear"></div> <?php  if(sizeof($wp_places->posts)!=sizeof($irc_places['items'])){ $IRCnumFleetUpdate = (sizeof($irc_places['items'])-sizeof($wp_places->posts)); if($IRCnumFleetUpdate && $IRCnumFleetUpdate>0) $irc_import_alerts[] = $IRCnumFleetUpdate." "._irct("nuevos lugares en")." ".$code['native_name']." " ._irct("disponibles para su importación a Wordpress"); }?></div> <?php  }?> <hr class="irchrs2" /> <strong><?php  echo _irct("Opciones de importación") ?>:</strong><br /><br /> <div> <div class="ircpleftpermt" style="width:8%; max-width: 30px;"> <input id="irchk_import_default" type="checkbox" checked="checked" style="margin:2px" autocomplete="off" disabled="disabled" /> </div> <div class="ircpleftpermt" style="padding-left:10px;width:88%;"> <?php  echo _irct("Insertar el contenido por defecto si no esta disponible en el idioma de la importación") ?>. </div> <div class="ircpclear"></div> <?php  $irc_GMapsKey = $this->get_field_value('irc_gmaps_key'); ?> <div class="ircpleftpermt" style="width:8%; max-width: 30px;"> <input id="irchk_import_place_map" type="checkbox" style="margin:2px" <?php  if($irc_GMapsKey!=''){?>checked="checked"<?php  }else{?>disabled="disabled"<?php  }?> autocomplete="off" /> </div> <div class="ircpleftpermt" style="padding-left:10px;width:88%;"> <?php  echo _irct("Insertar mapa de situación en la ficha del lugar en Wordpress") ?>.<?php  if($irc_GMapsKey==''){?><br /> <a href="admin.php?page=ibexrentacar&tab=settings"><?php  echo _irct("Debe configurar su clave para Google Maps Embed API") ?></a> <?php  }?> </div> <div class="ircpclear"></div><div class="ircpleftpermt" style="width:8%; max-width: 30px;"> <input id="irchk_import_place_image" type="checkbox" style="margin:2px" checked="checked" autocomplete="off" /> </div> <div class="ircpleftpermt" style="padding-left:10px;width:88%;"><?php  echo _irct("Exportar/Actualizar la imagen del lugar") ?>.</div> <div class="ircpclear"></div> <div class="ircpleftpermt" style="width:8%; max-width: 30px;"> <input id="irchk_import_delete_inactive" type="checkbox" style="margin:2px" autocomplete="off" /> </div> <div class="ircpleftpermt" style="padding-left:10px;width:88%;"> <?php  echo _irct("Eliminar de Wordpress las categorías y/o modelos inactivos en IRC") ?>. </div> <div class="ircpclear"></div><br /> </div><hr class="irchrs2" /> <div class="ircpleft"> <a href="admin.php?page=ibexrentacar&tab=import&type=place" style="text-decoration: none"> <input type="button" class="ircpButtonGrey" value="<?php  echo _irct("Actualizar") ?>" /> </a> </div> <div class="ircpright"> <div class="ircpButtonGreen" onclick="sincronizaplace()"><?php  echo _irct("Sincronizar") ?></div> </div> <div class="ircpclear"></div><hr class="irchrs2" /> <strong><?php  echo _irct("Opciones avanzadas") ?>:</strong><br /> <a href="#" onclick="ircunsetwpplaces()" style="text-decoration: none"><?php  echo _irct("Eliminar todos los lugares de Wordpress") ?></a> </div> <div class="ircpclear"></div> </div></div></form>